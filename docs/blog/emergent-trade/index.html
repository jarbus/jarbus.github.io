<!doctype html><html lang=en-us data-theme><head><link rel=preload href=../../unifont-small.woff2 as=font type=font/woff2 crossorigin=anonymous><meta charset=utf-8><meta name=HandheldFriendly content="True"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer-when-downgrade"><a rel=me href=https://fosstodon.org/@jarbus></a><title>Emergent Trade and Tolerated Theft Using Multi-Agent Reinforcement Learning - </title><meta name=description content="I&rsquo;ve been an author on a few papers before, but I recently published the first research project where I was responsible for most of the work and direction. It&rsquo;s in the first 2024 issue of the journal Artificial Life, which you can find here. You can find a non-paywalled version here Below, I tell the chronology of the project and summarize our findings.


We explore the conditions under which trade can emerge between four deep reinforcement learning agents that pick up and put down resources in a 2D foraging environment. Agents are rewarded for having both resources once, but the resources are distributed far apart from each other. To maximize reward, agents need to split up the work - agent 1 goes to resource A, agent 2 goes to resource B, etc, and then they meet to exchange resources, since meeting halfway can get them the most of each resource in the shortest amount of time."><link rel=icon type=image/png href=../../favicon.png><link rel=apple-touch-icon-precomposed href=../../favicon.png><style>body{visibility:hidden;opacity:0}</style><noscript><style>body{visibility:visible;opacity:1}</style></noscript><link rel=stylesheet href=../../css/style.min.86e95aed90b2c13a36036bcd828b55c65e25e8250f2b655d072838f66cb51223.css integrity="sha256-hula7ZCywTo2A2vNgotVxl4l6CUPK2VdByg49my1EiM="><script src=../../js/script.min.74bf1a3fcf1af396efa4acf3e660e876b61a2153ab9cbe1893ac24ea6d4f94ee.js type=text/javascript integrity="sha256-dL8aP88a85bvpKzz5mDodrYaIVOrnL4Yk6wk6m1PlO4="></script><meta property="og:url" content="/blog/emergent-trade/"><meta property="og:title" content="Emergent Trade and Tolerated Theft Using Multi-Agent Reinforcement Learning"><meta property="og:description" content="I’ve been an author on a few papers before, but I recently published the first research project where I was responsible for most of the work and direction. It’s in the first 2024 issue of the journal Artificial Life, which you can find here. You can find a non-paywalled version here Below, I tell the chronology of the project and summarize our findings.
We explore the conditions under which trade can emerge between four deep reinforcement learning agents that pick up and put down resources in a 2D foraging environment. Agents are rewarded for having both resources once, but the resources are distributed far apart from each other. To maximize reward, agents need to split up the work - agent 1 goes to resource A, agent 2 goes to resource B, etc, and then they meet to exchange resources, since meeting halfway can get them the most of each resource in the shortest amount of time."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2024-02-04T12:14:25-05:00"><meta property="article:modified_time" content="2024-02-04T12:14:25-05:00"><meta property="article:tag" content="Programming"><meta property="article:tag" content="Ai"></head><body><a class=skip-main href=#main>Skip to main content</a><div class=container><header class=common-header><div class=header-top><h1 class=site-title><a href=../../></a></h1></div><img src=../../dithered-tree-contrast.gif alt="Dithered Tree" style="display:block;margin:0 auto;max-height:20vh"><nav><a href=../../ title=home>~jarbus</a>
<a href=../../blog/ title=posts>posts</a>
<a href=../../list title=list>list</a>
<a href=../../index.xml title=Rss>rss</a></nav></header><main id=main tabindex=-1><article class="post h-entry"><div class=post-header><header><h1 class="p-name post-title">Emergent Trade and Tolerated Theft Using Multi-Agent Reinforcement Learning</h1></header></div><div class="content e-content"><p>I&rsquo;ve been an author on a few papers before, but I recently published the first research project where I was responsible for most of the work and direction. It&rsquo;s in the first 2024 issue of the journal <em>Artificial Life</em>, which you can find <a href=https://direct.mit.edu/artl/article-abstract/doi/10.1162/artl_a_00423/119154/Emergent-Resource-Exchange-and-Tolerated-Theft>here</a>. You can find a non-paywalled version <a href=../../trade-paper.pdf>here</a> Below, I tell the chronology of the project and summarize our findings.</p><p><img src=../../trade.gif alt="Emergent Trade" loading=lazy></p><p>We explore the conditions under which trade can emerge between four deep reinforcement learning agents that pick up and put down resources in a 2D foraging environment. Agents are rewarded for having both resources once, but the resources are distributed far apart from each other. To maximize reward, agents need to split up the work - agent 1 goes to resource A, agent 2 goes to resource B, etc, and then they meet to exchange resources, since meeting halfway can get them the most of each resource in the shortest amount of time.</p><p>I was working on this for a while in isolation, getting nowhere, and slowly going crazy. A few months later, Deepmind published a <a href=https://arxiv.org/abs/2205.06760>paper</a> that explored this exact behavior&mdash;and found that agents could not discover how to exchange goods without programming a trading system into the game mechanics directly. I was getting similar results, but found that this trading behavior could emerge if I rewarded agents for being physically close to one another, which we&rsquo;ll call a &ldquo;community bonus&rdquo;.</p><p>I reached out to the authors (great people btw), and they hypothesized that the trading behavior was a result of agents trying to keep each other alive to get the community bonus. In my setup, agents could die if they ran out of resources, so they were also keeping each other alive for company. The authors suggested I add some sort of &ldquo;market&rdquo;, a place for agents to meet up and trade without getting directly rewarded for giving away resources for free.</p><p>They explored similar ideas in their work, and if they couldn&rsquo;t get this behavior to emerge, what chance did I have? I needed to try something similar but sufficiently different.</p><p>Instead of adding a market where agents could come and go as they please, I added a campfire and a day-night cycle. I gave negative reward to agents for being out in the dark, which incentivizes them to gather around the campfire near others. Agents would only have enough time during the day to forage a single resource.</p><p>As it turns out, agents really, <em>really</em> don&rsquo;t want to learn this behavior. It&rsquo;s easy for agents to get cheated out of the resources they offer by others who offer nothing in return, so they gather as much as possible on their own. They even forage at night if the darkness penalty isn&rsquo;t severe enough.</p><p>Eventually, after 4+ days of training time, agents start to realize that working together isn&rsquo;t so bad and land on a trading protocol where agents stand back, drop an offer, then walk over to collect the resources dropped by others. Experiments show that agents keep their distance initially so they can reclaim their offer if their trading partner attempts to cheat them.</p><p>In one trial, agents converge on a local minimum, where agents 1&amp;2 go to the same area to collect resource A, agent 3 goes to collect resource B, and agent 4 collects a bit of the other remaining resources. In this setting, we notice a behavior which we dub &ldquo;Tolerated Theft&rdquo;. When agent 1 collects significantly more of resource A than agent 2, agent 2 tries to steal the resources exchanged between agents 1 and 3. To defend against this, agent 1 will drop some resources away from agent 3, to get agent 2 off their backs while they trade. This is particularly interesting, because an agent manages to &ldquo;steal&rdquo; resources without us adding a combat or larceny system. Nature truly does find a way.</p><p>I recommend checking out the <a href=https://arxiv.org/abs/2307.01862>arxiv pre-print</a> if you are interested in the details and figures.</p></div><div class=post-info><div class="post-date dt-published">2024-02-04</div><a class="post-hidden-url u-url" href=../../blog/emergent-trade/>/blog/emergent-trade/</a>
<a href=../../ class="p-name p-author post-hidden-author h-card" rel=me>jarbus</a><div class=post-taxonomies><ul class=post-tags><li><a href=../../tags/programming/>#Programming</a></li><li><a href=../../tags/ai/>#Ai</a></li></ul></div></div></article><h3 class=read-next-title>Read next</h3><ul class=read-next-posts><li><a href=../../blog/take-the-road-most-documented/>Take the Road Most Documented</a></li><li><a href=../../blog/numerical-stability-in-flash-attention/>Numerical Stability in Flash Attention</a></li><li><a href=../../blog/introducing-kittyplot/>Introducing Kittyplot</a></li><li><a href=../../blog/unexpected-benefits-of-testing/>Unexpected Benefits of Testing Code</a></li><li><a href=../../blog/ai-index/>AI Index</a></li></ul><div class="pagination post-pagination"><div class="left pagination-item"><a href=../../blog/zen-in-the-art-of-beat-saber/>Zen in the Art of Beat Saber</a></div><div class="right pagination-item"><a href=../../blog/take-the-road-most-documented/>Take the Road Most Documented</a></div></div></main><footer class=common-footer><div class=common-footer-bottom><script>document.addEventListener("DOMContentLoaded",function(){document.documentElement.setAttribute("data-theme","dark"),showContent()});function showContent(){document.body.style.visibility="visible",document.body.style.opacity=1}</script></div><p class="h-card vcard"><a href=../../ class="p-name u-url url fn" rel=me>jarbus</a>
/
<a class="p-email u-email email" rel=me href=mailto:jarbus@tutanota.com>jarbus@tutanota.com</a></p></footer></div></body></html>